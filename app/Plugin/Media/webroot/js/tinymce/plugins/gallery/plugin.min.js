tinymce.PluginManager.add('gallery', function(editor) {
  function openmanager(){
    win = editor.windowManager.open({
      title: "Gallery",
      file: editor.settings.gallery_path,
      width: 860,
      height: 570,
      inline: 1,
      resizable: true,
      maximizable: true
    });
  }

  editor.addShortcut('Ctrl+E', '', openmanager);

  editor.addButton('gallery', {
    icon: 'image',
    tooltip: 'Image',
    shortcut: 'Ctrl+E',
    onclick:openmanager
  });
});